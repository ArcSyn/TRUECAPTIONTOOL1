# üé¨ CaptionFlow Enhanced JSX Export

## Phase 1 Complete: SRT ‚Üí JSX Engine for After Effects

Your SRT to JSX (After Effects script) pipeline is now fully implemented! This system converts subtitle files into executable After Effects scripts with professional styling and scene management.

## ‚ú® What's New

### üß† Enhanced JSX Engine
- **Professional Styling**: 3 preset styles (Modern, Minimal, Bold) with customizable fonts, colors, shadows, and animations
- **Scene Breakdown**: Automatic scene detection based on silence gaps
- **Advanced Animations**: Fade-in, slide-up, and custom timing animations
- **Precise Positioning**: Configurable text positioning with stroke, shadow, and justification

### üé® Style Templates
- **Modern**: Arial-Bold, white text, black stroke, bottom-center, fade-in animation
- **Minimal**: Helvetica-Light, clean white text, no stroke, minimal design
- **Bold**: Impact font, yellow text, heavy black stroke, slide-up animation

### üìö Scene Mode
- Automatically splits captions into scenes based on gaps (default: 2+ seconds)
- Creates individual JSX files per scene (`scene_001.jsx`, `scene_002.jsx`, etc.)
- Includes master controller file with scene overview

## üöÄ Usage Methods

### 1. CLI Tool (Terminal)
```bash
# Basic JSX export
npm run jsx-export captions.srt --style modern

# Scene-based export with custom settings
npm run jsx-export captions.srt --scenes --gap 3.0 --project "My Video Project"

# Help and options
npm run jsx-help
```

### 2. Web Interface
1. Upload your video
2. Generate transcription
3. Go to Export Options
4. Select "Enhanced JSX" card
5. Choose style template and scene settings
6. Preview and download JSX files

### 3. API Endpoints
```javascript
// Enhanced JSX export
POST /api/export/jsx/enhanced
{
  "transcriptionId": "abc123",
  "projectName": "My Project",
  "styleName": "modern",
  "sceneMode": true,
  "gapThreshold": 2.0
}

// Get available styles
GET /api/export/jsx/styles

// Preview JSX output
POST /api/export/jsx/preview
```

## üìã CLI Options

| Option | Description | Default |
|--------|-------------|---------|
| `--style` | Style template: modern, minimal, bold | modern |
| `--scenes` | Enable scene mode (split into multiple files) | false |
| `--gap` | Scene gap threshold in seconds | 2.0 |
| `--project` | Project name for file naming | "Caption Project" |
| `--output` | Output directory | ./output |

## üéØ After Effects Integration

### Import Method
1. **File ‚Üí Scripts ‚Üí Run Script File**
2. **Select the exported `.jsx` file**
3. **Make sure you have a composition selected**
4. **Script will create text layers with proper timing**

### What Gets Created
- Text layer per caption with precise timing
- Professional styling (font, color, stroke, shadow)
- Animations (fade-in, slide-up based on style)
- Proper positioning and justification
- Scene organization (if scene mode enabled)

## üîß Technical Architecture

### Server-Side Components
- **`jsxExportService.js`**: Core JSX generation engine
- **Enhanced export routes**: RESTful API endpoints
- **SRT Parser**: Converts SRT format to caption objects
- **Scene Detector**: Analyzes gaps to create scene boundaries

### Client-Side Components
- **Enhanced ExportOptions**: React component with JSX export UI
- **API Functions**: TypeScript functions for JSX export operations
- **Type Definitions**: Comprehensive typing for JSX export options

### Style System
```javascript
// Example style configuration
{
  font: "Arial-Bold",
  fontSize: 65,
  color: [1, 1, 1], // RGB values 0-1
  strokeColor: [0, 0, 0],
  strokeWidth: 3,
  position: [0.5, 0.85], // Relative to comp size
  justification: "CENTER_JUSTIFY",
  animation: "fadeIn",
  shadow: true,
  shadowDistance: 5
}
```

## üìä Example Output

### Single JSX File
```javascript
// After Effects Caption Script - My Project
// Generated by CaptionFlow Enhanced

function addCaptions() {
    var comp = app.project.activeItem;
    
    if (!comp || !(comp instanceof CompItem)) {
        alert("Please select a composition first.");
        return;
    }
    
    app.beginUndoGroup("Add Enhanced Captions");
    
    var captions = [
        {
            "id": 1,
            "startTime": 10.5,
            "endTime": 13.24,
            "text": "Welcome to our presentation",
            "duration": 2.74
        }
        // ... more captions
    ];
    
    // Professional styling and animation code...
}

addCaptions();
```

### Scene Mode Output
- `master.jsx` - Scene controller and overview
- `scene_001.jsx` - First scene (0:00 - 0:45)
- `scene_002.jsx` - Second scene (0:48 - 1:30)
- `scene_003.jsx` - Third scene (1:35 - 2:15)

## üõ£Ô∏è Next Steps (Phase 2+)

### Phase 2: Advanced Scene Management
- [ ] ML-based scene detection (speaker changes, visual cues)
- [ ] Scene templates with different layouts
- [ ] Batch processing for multiple videos

### Phase 3: Advanced Styling
- [ ] Custom style JSON import/export
- [ ] Live preview in browser
- [ ] Brand template system

### Phase 4: Full Automation
- [ ] Direct After Effects integration via CEP panels
- [ ] Auto-import to After Effects project
- [ ] Template marketplace

## üéØ Implementation Checklist

‚úÖ **Phase 1 Complete**
- ‚úÖ SRT parsing and caption extraction
- ‚úÖ JSX script generation with professional styling
- ‚úÖ Scene breakdown based on gaps
- ‚úÖ 3 preset style templates
- ‚úÖ CLI tool for batch processing
- ‚úÖ Web interface integration
- ‚úÖ RESTful API endpoints
- ‚úÖ TypeScript type definitions
- ‚úÖ Animation support (fade-in, slide-up)

## üî• Usage Examples

### CLI Examples
```bash
# Modern style single file
npm run jsx-export my_video.srt --style modern --project "Product Demo"

# Scene-based export with minimal style
npm run jsx-export interview.srt --scenes --style minimal --gap 1.5

# Bold style with custom output directory
npm run jsx-export presentation.srt --style bold --output ./ae-scripts
```

### JavaScript API Examples
```javascript
// Export enhanced JSX
const result = await exportEnhancedJSX('trans_123', {
  projectName: 'Marketing Video',
  styleName: 'bold',
  sceneMode: true,
  gapThreshold: 2.5
});

// Get available styles
const styles = await getJSXStyles();

// Preview before export
const preview = await previewJSX('trans_123', {
  styleName: 'modern',
  sceneMode: false
});
```

---

## üéâ Success! Your SRT ‚Üí JSX Pipeline is Ready

You now have a complete, production-ready system for converting video transcriptions into professional After Effects scripts. The system supports both single-file and scene-based exports with multiple styling options.

**Ready to use:** Upload a video, transcribe it, and export professional JSX scripts for After Effects!
